<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>


    <title>Inscreva-se !</title>
</head>
<header>
    <div class="container">
      <h1 class="logo">
        <img src="assets/img/logo.png" alt="" width="150px" />
      </h1>
      <ul class="navbar">
        <li><a href="index.html">Home</a></li>
        <li><a href="#txt_sobre">Sobre</a></li>
        <li><a href="#txt_materias">Mat√©rias</a></li>
        <li><a href="cadastro.html">Matr√≠cula</a></li>
        <li><a href="login.html">Login</a></li>
        </button>
      </ul>
        </div>
  </header>
<body>

    <div class="caixaExternaCadastro">
        <div class="areaFormularioCadastro">
          <h1>Bem vindo,<br> Se inscreva e viva de magia.</h1>
          <h4>Se increva apenas ap√≥s realizar o teste de casas. <br>
          Caso ainda n√£o tenha realizado, realize agora, clicando aqui. </h4>
          <img src="assets/img/pena_cadastro.png" id="imgLogin" alt="">
        </div>

        <div class="areaImagemCadastro">
            <div class="cardLoginCadastro">
                <h1>MATRICULE-SE</h1>
                <div class="textfield">
                    <label for="usuario">Primeiro nome</label>
                    <input type="text" id="user_input" placeholder="Primeiro nome"><br>
                </div>
                <div class="textfield">
                  <label for="usuario">Sobrenome</label>
                  <input type="text" id="sobrenome_input" placeholder="√öltimo Sobrenome"><br>
              </div>

                <div class="textfield">
                  <label for="usuario">Nickname</label>
                  <input type="text" id="nickname_input" placeholder="Mostre como gostaria de ser chamado"><br>
              </div>

                <div class="textfield">
                    <label for="usuario">Data de Nascimento</label>
                    <input type="date" id="dtNasc_input" placeholder="Data de nascimento"><br>

                </div>
                <div class="textfield">
                  <label for="usuario">Qual sua origem</label>
                  <select id="origemCheck">
                    <option value="1">Bruxa</option>
                    <option value="2">Trouxa</option>
                    <option value="3">Mista</option>
                </select>
                              </div>

              <div class="textfield">
                <label for="usuario">Casa pertencente. </label>
                <select id="casaCheck">
                  <option value="1">Grifin√≥ria</option>
                  <option value="2">Lufa-Lufa</option>
                  <option value="3">Corvinal</option>
                  <option value="3">Sonserina</option>
              </select>
                          </div>
            <div class="textfield">
              <label for="usuario">Senha</label>
              <input type="password" id="senha_input" placeholder="Senha"><br>
          </div>

                <button onclick="cadastrar()" class="botaoAcesso">ENTRAR</button>

            </div>
        </div>
    </div>
    
</body>
<footer>

  <div id="container_rodape">

  <div id="logo_rodape">

    <img src="/site/public/assets/img/logo.png" alt="Logo rodap√©" width="150px">

  </div>

  <div id="informacoes_rodape">

    <span>VIVA A MAGIA ‚ô• </span>

  </div>
</div>
</footer>

</html>
<script>
  function cadastrar() {
        //aguardar();

        //Recupere o valor da nova input pelo nome do id
        // Agora v√° para o m√©todo fetch logo abaixo
        var nomeVar = nickname_input.value;
        var primeiroNomeVar = user_input.value;
        var sobrenomeVar = sobrenome_input.value;
        var dtNascimentoVar = dtNasc_input.value;
        var senhaVar = senha_input.value;
        var origemVar = origemCheck.value;
        var casaVar = casaCheck.value;


        if (nomeVar == "" || primeiroNomeVar == "" || sobrenomeVar == "" || dtNascimentoVar == "" || senhaVar == "" || origemVar == "" || casaVar == "") {
            //cardErro.style.display = "block"
            swal("Ops", "Preencha todos os campos üò†", "error")


            finalizarAguardar();
            return false;
        }
        else if (nomeVar.length < 8) {
            swal("Ops", "O nome inserido √© muito curto. Por favor, insira um nome com pelo menos 8 caracteres üò†", "warning")
        }
        else if (senhaVar.length < 8) {
            swal("Ops", "A senha inserida √© muito curta. Por favor,insira uma senha com pelo menos 8 caracteres üò†", "warning")
        }
        else {
            setInterval('oi', 5000)





            // Enviando o valor da nova input
            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora v√° para o arquivo routes/usuario.js
                    nomeServer: nomeVar,
                    senhaServer: senhaVar,
                    origemServer: origemVar,
                    casaServer: casaVar

                })
            }).then(function (resposta) {

                console.log("resposta: ", resposta);

                if (resposta.ok) {
                    //cardErro.style.display = "block";
                    swal("Par√°bens", "Cadastro realizado com sucesso redirecionando a tela de login üòÑ...!", "success");


                    setTimeout(() => {
                        window.location = "login.html";
                    }, 3000)

                    limparFormulario();
                    finalizarAguardar();
                } else {
                    swal("Ops", "Mais de um usu√°rio com o mesmo login e senha üò≠!")
                }
            }).catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
                finalizarAguardar();
            });

            return false;
        }
    }

    //function sumirMensagem() {
        //cardErro.style.display = "none"
    //}


</script>